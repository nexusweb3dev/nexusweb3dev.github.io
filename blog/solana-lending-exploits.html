<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Solana Lending Security: $200M in Exploits | NexusWeb3</title>
    <meta name="description" content="Technical breakdown of Mango Markets ($116M), Cashio ($52M), and three other Solana lending exploits. Real code patterns, detection methods, and prevention strategies.">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        :root {
            --bg: #0a0a0a;
            --bg-secondary: #0f0f0f;
            --bg-tertiary: #1a1a1a;
            --border: #262626;
            --text: #ffffff;
            --text-secondary: #a3a3a3;
            --accent: #00ff88;
        }
        body {
            font-family: 'Inter', sans-serif;
            background: var(--bg);
            color: var(--text);
            line-height: 1.7;
        }
        header {
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border);
            padding: 1.5rem 0;
            position: sticky;
            top: 0;
            z-index: 1000;
        }
        header .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 0 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        header a {
            color: var(--text);
            text-decoration: none;
            font-weight: 600;
        }
        header a:hover { color: var(--accent); }
        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 0 2rem;
        }
        article {
            padding: 4rem 0;
        }
        h1 {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 1rem;
            line-height: 1.2;
        }
        .meta {
            color: var(--text-secondary);
            margin-bottom: 3rem;
            padding-bottom: 2rem;
            border-bottom: 1px solid var(--border);
        }
        h2 {
            font-size: 1.75rem;
            font-weight: 600;
            margin: 3rem 0 1rem;
            color: var(--accent);
        }
        h3 {
            font-size: 1.25rem;
            font-weight: 600;
            margin: 2rem 0 1rem;
        }
        p {
            margin-bottom: 1.5rem;
        }
        a {
            color: var(--accent);
            text-decoration: none;
        }
        a:hover { text-decoration: underline; }
        code {
            font-family: 'JetBrains Mono', monospace;
            background: var(--bg-tertiary);
            padding: 0.2rem 0.4rem;
            border-radius: 3px;
            font-size: 0.9em;
        }
        pre {
            background: var(--bg-tertiary);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 1.5rem;
            overflow-x: auto;
            margin: 1.5rem 0;
        }
        pre code {
            background: none;
            padding: 0;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 2rem 0;
        }
        th, td {
            padding: 0.75rem;
            text-align: left;
            border-bottom: 1px solid var(--border);
        }
        th {
            font-weight: 600;
            color: var(--accent);
        }
        ul, ol {
            margin-left: 2rem;
            margin-bottom: 1.5rem;
        }
        li {
            margin-bottom: 0.5rem;
        }
        .highlight {
            background: var(--bg-tertiary);
            border-left: 3px solid var(--accent);
            padding: 1rem 1.5rem;
            margin: 2rem 0;
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <a href="/">← NexusWeb3</a>
            <nav>
                <a href="/blog">Research</a>
                <a href="/about.html">About</a>
            </nav>
        </div>
    </header>

    <article class="container">
        <h1>Solana Lending Security: $200M in Exploits</h1>
        <div class="meta">
            February 12, 2026 · 15 min read · Solana, Security
        </div>

        <p>Between late 2022 and early 2023, Solana lost over $200 million to lending protocol exploits. Not sophisticated zero-days — preventable bugs in oracle integration, account validation, and math precision.</p>

        <p>We analyzed five major incidents with transaction-level detail. Here's what broke.</p>

        <h2>The Exploits</h2>

        <table>
            <tr>
                <th>Protocol</th>
                <th>Date</th>
                <th>Loss</th>
                <th>Root Cause</th>
            </tr>
            <tr>
                <td>Mango Markets</td>
                <td>Oct 2022</td>
                <td>$116M</td>
                <td>Oracle manipulation via thin markets</td>
            </tr>
            <tr>
                <td>Cashio</td>
                <td>Mar 2022</td>
                <td>$52.8M</td>
                <td>Missing mint validation</td>
            </tr>
            <tr>
                <td>Crema Finance</td>
                <td>Jul 2022</td>
                <td>$8.8M</td>
                <td>Missing signer check</td>
            </tr>
            <tr>
                <td>Nirvana Finance</td>
                <td>Jul 2022</td>
                <td>$3.5M</td>
                <td>Flash loan math error</td>
            </tr>
        </table>

        <h2>1. Mango Markets: Oracle Manipulation ($116M)</h2>

        <p><strong>Transaction:</strong> <code>4RMrPmAGdAvxtNJUdF7MwiEKXfjoNciEbVdG2FMKaoSdNYeiyvmp3nKYmSTiojf3z5kKKS5pH3CqkLq2ZP4DdPB8</code></p>

        <p>Attacker opened massive leveraged longs in MNGO perpetuals, pumped MNGO spot price on thin-liquidity exchanges, inflated collateral value via Pyth oracle update, borrowed $116M, let price collapse.</p>

        <h3>The Bug</h3>

        <pre><code class="language-rust">// VULNERABLE: No oracle validation
pub fn get_price(oracle: &AccountInfo) -> Result&lt;I80F48&gt; {
    let price_data = load_pyth_price(oracle)?;
    Ok(I80F48::from_num(price_data.agg.price)) // ❌ Direct use
}</code></pre>

        <p>Missing checks:</p>
        <ul>
            <li>Confidence interval (how much publishers disagree)</li>
            <li>TWAP comparison (is this a spike?)</li>
            <li>Rate-of-change limiter (30x jump in 60 seconds)</li>
            <li>Staleness check (when was this updated?)</li>
        </ul>

        <h3>The Fix</h3>

        <pre><code class="language-rust">pub fn get_safe_price(oracle: &AccountInfo) -> Result&lt;I80F48&gt; {
    let price_data = load_pyth_price(oracle)?;
    let slot = Clock::get()?.slot;
    
    // Staleness check
    require!(
        slot - price_data.agg.pub_slot < 25, // ~10 seconds
        ErrorCode::StaleOracle
    );
    
    // Confidence check
    let conf_pct = price_data.agg.conf / price_data.agg.price.abs();
    require!(conf_pct < 0.02, ErrorCode::ConfidenceTooWide); // 2%
    
    // TWAP comparison
    let ema_price = price_data.ema_price.price;
    let deviation = (price_data.agg.price - ema_price).abs() / ema_price;
    require!(deviation < 0.10, ErrorCode::PriceManipulation); // 10%
    
    Ok(I80F48::from_num(price_data.agg.price))
}</code></pre>

        <p>These five checks would have rejected the manipulated price and capped the loss at ~$5M (attacker's initial capital).</p>

        <h2>2. Cashio: Fake Collateral ($52.8M)</h2>

        <p><strong>Transaction:</strong> <code>2CuT6SHtaXrMdiSmHLBd3PvPNVzfY5JrhBqA8HMaDBSwtkYhNUJouUw6FzhdLMBLLr4wx2Bvev1b5fKdLDmRoCN</code></p>

        <p>Cashio accepted Saber LP tokens as collateral. It checked account type but not mint address. Attacker created a fake Saber pool with worthless tokens, minted billions of fake LP tokens, deposited as collateral, minted $52.8M CASH stablecoins, sold for real USDC.</p>

        <h3>The Bug</h3>

        <pre><code class="language-rust">// VULNERABLE: No mint constraint
#[account(mut)]
pub user_collateral: Account&lt;'info, TokenAccount&gt;, // ❌ Any TokenAccount passes</code></pre>

        <h3>The Fix</h3>

        <pre><code class="language-rust">// SECURE: Explicit mint validation
#[account(
    mut,
    constraint = user_collateral.mint == EXPECTED_MINT @ ErrorCode::InvalidMint
)]
pub user_collateral: Account&lt;'info, TokenAccount&gt;,</code></pre>

        <p>One constraint. $52.8M saved.</p>

        <h2>3. Crema: Missing Signer Check ($8.8M)</h2>

        <p>Admin function <code>update_tick_array</code> accepted a config account but didn't verify the signer. Attacker passed their own fake config account, overwrote price tick data, swapped at manipulated prices.</p>

        <h3>The Fix</h3>

        <pre><code class="language-rust">// SECURE: Require admin signature
#[account(
    constraint = admin.key() == config.authority @ ErrorCode::Unauthorized
)]
pub admin: Signer&lt;'info&gt;,</code></pre>

        <h2>Detection Checklist</h2>

        <p>For every Solana lending protocol:</p>

        <ul>
            <li>Does oracle integration validate confidence, staleness, TWAP?</li>
            <li>Are all token mints validated against a whitelist?</li>
            <li>Do admin functions require Signer constraints?</li>
            <li>Are PDA seeds validated with correct bump?</li>
            <li>Is fixed-point math used for interest calculations?</li>
        </ul>

        <h2>Conclusion</h2>

        <p>These bugs were 100% preventable. The common thread: <strong>insufficient validation of external state</strong>.</p>

        <p>Use Anchor constraints aggressively. Validate oracles with multiple checks. Test with mainnet forks. Get audited by OtterSec, Neodyme, or Sec3 before deployment.</p>

        <p>Oracle manipulation is economics 101. If you can profitably move a price, someone will.</p>

        <hr style="margin: 3rem 0; border: none; border-top: 1px solid var(--border);">

        <p><em>More exploit analysis? Read our <a href="/blog/oracle-manipulation.html">Mango Markets deep-dive</a> or <a href="/blog/first-depositor-attack.html">ERC-4626 donation attacks</a>.</em></p>
    </article>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-rust.min.js"></script>
</body>
</html>
